--login to server
ssh dev_user@192.168.1.190


____________________________________________________________________________________
-- common house keeping
------------------------------------------------------------------------------------

-- ngrok
---- Get URL
curl http://localhost:4040/api/tunnels | grep public
---- run
nohup ngrok http 5000 >/dev/null 2>&1 &


ps -aux | grep app.py
kill -9 


cd tasks-app/home-app-v1/
nohup python3 app.py > /dev/null 2>&1 &
ps -aux | grep app.py



____________________________________________________________________________________
-- git commands
------------------------------------------------------------------------------------
---- Update code: 
cd /home/dev_user/tasks-app/home-app-v1 
git pull origin main


---- restart: 
sudo systemctl restart tasks-app


---- Check logs: 
sudo journalctl -u tasks-app


---- switch to branch:
git checkout nash34-patch-2


____________________________________________________________________________________
-- auto-restart on server
------------------------------------------------------------------------------------
sudo nano /etc/systemd/system/tasks-app.service

[Unit]
Description=Tasks App
After=network.target

[Service]
User=dev_user
WorkingDirectory=/home/dev_user/tasks-app/home-app-v1
Environment="PATH=/home/dev_user/tasks-app/home-app-v1/venv/bin"
Environment="FLASK_APP=app.py"
Environment="FLASK_ENV=production"
ExecStart=/home/dev_user/tasks-app/home-app-v1/venv/bin/python3 -m flask run --host=0.0.0.0 --port=5000
Restart=always

[Install]
WantedBy=multi-user.target

-- test it
-- Enable and Start the Service:
---- Reload systemd: 
sudo systemctl daemon-reload


---- Enable on boot: 
sudo systemctl enable tasks-app


---- Start the service: 
sudo systemctl start tasks-app


---- Check status: 
sudo systemctl status tasks-app


---- Test locally: 
curl http://localhost:5000


____________________________________________________________________________________
ngrok - Auto Restart
____________________________________________________________________________________

nano /home/dev_user/start-ngrok.sh

#!/bin/bash
/usr/local/bin/ngrok http 5000

chmod +x /home/dev_user/start-ngrok.sh

-- Add to crontab for boot: 
crontab -e
@reboot /home/dev_user/start-ngrok.sh &



____________________________________________________________________________________
-- SQLITE
------------------------------------------------------------------------------------

-- access DB
sqlite3 home.db

-- See all tables list
.tables

-- View DDL
PRAGMA table_info(users);

--
select * from users;


.exit




____________________________________________________________________________________
-- copy git files to server
------------------------------------------------------------------------------------

wget -P /home/dev_user/home-app-v1/templates/ https://raw.githubusercontent.com/nash34/tasks-app/main/home-app-v1/templates/landing.html
wget -P /home/dev_user/home-app-v1/static/ https://raw.githubusercontent.com/nash34/tasks-app/main/home-app-v1/static/style.css




____________________________________________________________________________________
-- intial setup
------------------------------------------------------------------------------------
pip3 install -r requirements.txt 





-- copy from local to server
scp -r /Users/dharmanunna/Documents/Projects/HOME-App/home-app-v1 dev_user@192.168.1.190:/home/dev_user/

scp -r /Users/dharmanunna/Documents/Projects/HOME-App/home-app-v1/static/style.css dev_user@192.168.1.190:/home/dev_user/home-app-v1/static/style.css

scp -r /Users/dharmanunna/Documents/Projects/HOME-App/home-app-v1/templates/home.html dev_user@192.168.1.190:/home/dev_user/home-app-v1/templates/home.html

scp -r /Users/dharmanunna/Documents/Projects/HOME-App/home-app-v1/app.py dev_user@192.168.1.190:/home/dev_user/home-app-v1/app.py
scp -r /Users/dharmanunna/Documents/Projects/HOME-App/home-app-v1/templates/landing.html dev_user@192.168.1.190:/home/dev_user/home-app-v1/templates/landing.html
scp -r /Users/dharmanunna/Documents/Projects/HOME-App/home-app-v1/templates/settings.html dev_user@192.168.1.190:/home/dev_user/home-app-v1/templates/settings.html
